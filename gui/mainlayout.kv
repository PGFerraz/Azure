#:import FitImage kivymd.uix.fitimage.FitImage

<MainLayout>:
    orientation: "vertical"

    # Gerenciador de Telas/Menus
    MDScreenManager:
        id: screen_manager

        # Tela de Guias
        MDScreen:
            name: "screen_guides"

            MDFloatLayout:
                md_bg_color: 0.122, 0.122, 0.145, 1

                # header com titulo e icones
                MDBoxLayout:
                    orientation: "horizontal"
                    size_hint: 1, None
                    height: dp(80)
                    pos_hint: {"top": 1}
                    padding: dp(20)
                    spacing: dp(15)

                    # logo/icone principal
                    MDIcon:
                        icon: "medical-bag"
                        size_hint: None, None
                        size: dp(40), dp(40)
                        theme_icon_color: "Custom"
                        icon_color: 0.2, 0.7, 1, 1
                        pos_hint: {"center_y": 0.5}

                    # titulo principal
                    MDLabel:
                        text: "Azure"
                        theme_text_color: "Custom"
                        text_color: 1, 1, 1, 1
                        font_size: "22sp"
                        bold: True
                        pos_hint: {"center_y": 0.5}

                    # spacer para empurrar icones para a direita
                    Widget:

                    # botao de notif.
                    MDIconButton:
                        icon: "bell"
                        size_hint: None, None
                        size: dp(40), dp(40)
                        theme_icon_color: "Custom"
                        icon_color: "white"
                        pos_hint: {"center_y": 0.5}

                    # botão de config.
                    MDIconButton:
                        icon: "cog"
                        size_hint: None, None
                        size: dp(40), dp(40)
                        theme_icon_color: "Custom"
                        icon_color: "white"
                        pos_hint: {"center_y": 0.5}

                # scrollview para o conteudo da page
                MDScrollView:
                    pos_hint: {"top": 0.88}
                    size_hint: 1, 0.88

                    MDBoxLayout:
                        orientation: "vertical"
                        spacing: dp(20)
                        padding: dp(20)
                        adaptive_height: True

                        # seção Recursos de Apoio - titulo
                        MDLabel:
                            text: "Recursos de Apoio"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            font_size: "18sp"
                            bold: True
                            size_hint_y: None
                            height: self.texture_size[1]
                            padding: [0, dp(15), 0, dp(5)]

                        # grid de cards principais (2 colunas)
                        MDGridLayout:
                            cols: 2
                            spacing: dp(15)
                            adaptive_height: True
                            size_hint_y: None

                            # card 1 - Tutoriais e Aprendizado
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("Tutoriais selecionado")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: dp(15)
                                    spacing: dp(1)
                                    size_hint_y: None
                                    height: dp(28)

                                    MDIcon:
                                        icon: "book-open-page-variant"
                                        size_hint: None, None
                                        size: dp(28), dp(28)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1
                                        halign: "left"

                                    MDLabel:
                                        text: "Tutoriais"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: None
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "Aprendizado e Documentos"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                            # card 2 - Quiz e testes
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("Quiz selecionado")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: dp(15)
                                    spacing: dp(1)

                                    MDIcon:
                                        icon: "head-question"
                                        size_hint: None, None
                                        size: dp(28), dp(28)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1

                                    MDLabel:
                                        text: "Quiz"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: None
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "teste seus conhecimentos"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                        # cards inferiores em grid 2x2
                        MDGridLayout:
                            cols: 2
                            spacing: dp(15)
                            adaptive_height: True
                            size_hint_y: None

                            # card 3 - Downloads de Aplicativos
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("Download de aplicativos")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: [dp(15), dp(25), dp(10), dp(25)] # mini observação>: [left, top, right, bottom]
                                    spacing: dp(1)

                                    MDIcon:
                                        icon: "download"
                                        size_hint: None, None
                                        size: dp(28), dp(28)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1

                                    MDLabel:
                                        text: "Downloads"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: None
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "de aplicativos"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                            # card 4 - Ferramentas Uteis
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("Ferramentas selecionadas")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: [dp(15), dp(3), dp(10), dp(3)] # mini observação>: [left, top, right, bottom]
                                    spacing: dp(1)

                                    MDIcon:
                                        icon: "cog"
                                        size_hint: None, None
                                        size: dp(25), dp(25)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1

                                    MDLabel:
                                        text: "Ferramentas Úteis"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: None
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "Tudo o que você precisa"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                            # Card 5 - Materiais e Conjteudos
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("Materiais e conteudos")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: [dp(15), dp(15), dp(10), dp(15)] # mini observação>: [left, top, right, bottom]
                                    spacing: dp(1)


                                    MDIcon:
                                        icon: "file-document"
                                        size_hint: None, None
                                        size: dp(28), dp(28)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1

                                    MDLabel:
                                        text: "Materiais e Conteúdos"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: None
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "de apoio"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                            # card 6 - FAQ - Perguntas e Respostas
                            MDCard:
                                size_hint_y: None
                                height: dp(120)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.18, 0.45, 0.55, 1
                                elevation: 3
                                on_release: print("FAQ selecionado")

                                MDBoxLayout:
                                    orientation: "vertical"
                                    padding: dp(15)
                                    spacing: dp(12)

                                    MDIcon:
                                        icon: "help-circle"
                                        size_hint: None, None
                                        size: dp(28), dp(28)
                                        theme_icon_color: "Custom"
                                        icon_color: 1, 1, 1, 1

                                    MDLabel:
                                        text: "FAQ"
                                        theme_text_color: "Custom"
                                        text_color: 1, 1, 1, 1
                                        font_size: "14sp"
                                        bold: True
                                        size_hint_y: 12
                                        height: self.texture_size[1]

                                    MDLabel:
                                        text: "Perguntas e Respostas"
                                        theme_text_color: "Custom"
                                        text_color: 0.9, 0.9, 0.9, 1
                                        font_size: "11sp"
                                        size_hint_y: None
                                        height: self.texture_size[1]

                        # seção de videos - titulo
                        MDLabel:
                            text: "Videos"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            font_size: "18sp"
                            bold: True
                            size_hint_y: None
                            height: self.texture_size[1]
                            padding: [0, dp(15), 0, dp(5)]

                        # cards de videos horizontais
                        MDBoxLayout:
                            orientation: "vertical"
                            spacing: dp(10)
                            adaptive_height: True
                            size_hint_y: None

                            # video 1 - Diferenças entre diabetes tipo 1 e 2
                            MDCard:
                                size_hint_y: None
                                height: dp(80)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.3, 0.3, 0.4, 1
                                elevation: 2
                                on_release: print("Video 1 selecionado")

                                MDBoxLayout:
                                    orientation: "horizontal"
                                    padding: dp(15)
                                    spacing: dp(15)

                                    # Thumbnail do video
                                    MDCard:
                                        size_hint: None, None
                                        size: dp(60), dp(50)
                                        radius: [10, 10, 10, 10]
                                        md_bg_color: 0.6, 0.4, 0.2, 1

                                        MDIcon:
                                            icon: "play-circle"
                                            size_hint: None, None
                                            size: dp(30), dp(30)
                                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                                            theme_icon_color: "Custom"
                                            icon_color: 1, 1, 1, 0.8

                                    # Informaçoes do video
                                    MDBoxLayout:
                                        orientation: "vertical"
                                        spacing: dp(3)

                                        MDLabel:
                                            text: "Diferenças entre diabetes tipo 1 e 2"
                                            theme_text_color: "Custom"
                                            text_color: 1, 1, 1, 1
                                            font_size: "14sp"
                                            bold: True
                                            size_hint_y: None
                                            height: self.texture_size[1]

                                        MDLabel:
                                            text: "Entenda as principais diferenças"
                                            theme_text_color: "Custom"
                                            text_color: 0.7, 0.7, 0.7, 1
                                            font_size: "12sp"
                                            size_hint_y: None
                                            height: self.texture_size[1]

                            # video 2 - O que é diabetes
                            MDCard:
                                size_hint_y: None
                                height: dp(80)
                                radius: [15, 15, 15, 15]
                                md_bg_color: 0.5, 0.2, 0.4, 1
                                elevation: 2
                                on_release: print("Video 2 selecionado")

                                MDBoxLayout:
                                    orientation: "horizontal"
                                    padding: dp(15)
                                    spacing: dp(15)

                                    # Thumbnail do video
                                    MDCard:
                                        size_hint: None, None
                                        size: dp(60), dp(50)
                                        radius: [10, 10, 10, 10]
                                        md_bg_color: 0.7, 0.3, 0.5, 1

                                        MDIcon:
                                            icon: "play-circle"
                                            size_hint: None, None
                                            size: dp(30), dp(30)
                                            pos_hint: {"center_x": 0.5, "center_y": 0.5}
                                            theme_icon_color: "Custom"
                                            icon_color: 1, 1, 1, 0.8

                                    # Informações do video
                                    MDBoxLayout:
                                        orientation: "vertical"
                                        spacing: dp(3)

                                        MDLabel:
                                            text: "O que é diabetes? E como controlar"
                                            theme_text_color: "Custom"
                                            text_color: 1, 1, 1, 1
                                            font_size: "14sp"
                                            bold: True
                                            size_hint_y: None
                                            height: self.texture_size[1]

                                        MDLabel:
                                            text: "Entenda mais sobre diabetes"
                                            theme_text_color: "Custom"
                                            text_color: 0.7, 0.7, 0.7, 1
                                            font_size: "12sp"
                                            size_hint_y: None
                                            height: self.texture_size[1]

        # Tela Principal/Home
        MDScreen:
            name: "screen_home"

            # Layout Principal
            MDFloatLayout:
                md_bg_color: 0.122, 0.122, 0.145

                # Linha Azul em cima da barra de navegação
                Widget:
                    size_hint: None, None
                    size: root.width, dp(6)
                    pos: 0, 0
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size

                MDLabel: 
                    text: "Primeiros Passos"
                    halign: "center"
                    pos_hint: {'center_x':0.18, 'top':1.29}
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1

                # Linha ao lado dos "Primeiros Passos"
                Widget:
                    size_hint: None, None
                    size: self.parent.width, dp(2)   
                    pos: 0, self.parent.height - dp(155) 
                    
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Line:
                            points: [self.parent.width*0.35, self.y, self.parent.width*1.01, self.y]  
                            width: 1
                
                # Botão de criar seu Perfil
                MDButton:
                    style: "filled"
                    theme_width: "Custom"
                    height: "60dp"
                    size_hint_x: .4
                    pos_hint: {'center_x':0.26, 'top':0.75}

                    MDButtonIcon:
                        icon: "account"

                    MDButtonText:
                        text: "Criando o seu \nPerfil"
                        the_font_size: "custom"
                        font_size: "8sp"

                # Botão Atalho para os Guias
                MDButton:
                    style: "filled"
                    theme_width: "Custom"
                    height: "60dp"
                    size_hint_x: .4
                    pos_hint: {'center_x':0.74, 'top':0.75}

                    MDButtonIcon:
                        x: text.x - (self.width + dp(8))
                        icon: "book"

                    MDButtonText:
                        id: text
                        text: "Guias e \nTutoriais"
                        pos_hint: {"center_x": .5, "center_y": .5}
                
                # Área de Notícias
                MDLabel: 
                    text: "Fique por Dentro"
                    halign: "center"
                    pos_hint: {'center_x':0.18, 'top':1.08}
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1

                # Linha que Separa a Seção de Notícias
                Widget:
                    size_hint: None, None
                    size: self.parent.width, dp(2)   
                    pos: 0, self.parent.height - dp(310) 
                    
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Line:
                            points: [self.parent.width*0.35, self.y, self.parent.width*1.01, self.y]  
                            width: 1
                
                # Botão de configurações
                MDIconButton:
                    icon: "cog"
                    style: "standard"
                    size_hint: 0.15, 0.08
                    pos_hint: {"center_x": 0.86, "top": 0.94}
                    theme_bg_color: "Custom"
                    md_bg_color: 0.122, 0.122, 0.145
                    theme_icon_color: "Custom"
                    icon_color: "white"

                # Botão de Notificações
                MDIconButton:
                    icon: "bell"
                    style: "standard"
                    size_hint: 0.15, 0.08
                    pos_hint: {"center_x": 0.70, "top": 0.94}
                    theme_bg_color: "Custom"
                    md_bg_color: 0.122, 0.122, 0.145
                    theme_icon_color: "Custom"
                    icon_color: "white"

        # Tela de Perfil
        MDScreen:
            name: "screen_profile"

            # Layout Principal
            MDFloatLayout:
                md_bg_color: 0.122, 0.122, 0.145
                
                # Linha Azul em cima da barra de navegação
                Widget:
                    size_hint: None, None
                    size: root.width, dp(6)
                    pos: 0, 0
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Rectangle:
                            pos: self.pos
                            size: self.size
                
                # Linha Horizontal do texto "Diário"
                Widget:
                    size_hint: None, None
                    size: self.parent.width, dp(2)
                    pos: 0, self.parent.height - dp(147)
                    
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Line:
                            points: [self.parent.width*0.25, self.y, self.parent.width*1.01, self.y]
                            width: 1
                
                # Linha Horizontal do texto "Mensal"
                Widget:
                    size_hint: None, None
                    size: self.parent.width, dp(2)
                    pos: 0, self.parent.height - dp(412)
                    
                    canvas:
                        Color:
                            rgba: 0, 0.6, 1, 1
                        Line:
                            points: [self.parent.width*0.29, self.y, self.parent.width*1.01, self.y]
                            width: 1

                # Nome de Usuário
                MDLabel:
                    text: "Username"
                    size_hint: 0.18, 0.13
                    pos_hint: {"center_x": 0.35, "top": 0.96}
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                
                # Texto "Diário"
                MDLabel:
                    text: "Diário"
                    size_hint: 0.20, 0.13
                    pos_hint: {"center_x": 0.16, "top": 0.87}
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    theme_font_size: "Custom"
                    font_size: "24sp" 
                
                # Texto "Mensal"
                MDLabel:
                    text: "Mensal"
                    size_hint: 0.20, 0.13
                    pos_hint: {"center_x": 0.16, "top": 0.525}
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    theme_font_size: "Custom"
                    font_size: "24sp" 

                # Imagem de Perfil
                Image:
                    source: root._imgDefaultAvatar
                    size_hint: 0.18, 0.13
                    pos_hint: {"center_x": 0.14, "top": 0.96}

                # Botão de configurações
                MDIconButton:
                    icon: "cog"
                    pos_hint: {"center_x": 0.86, "top": 0.93}
                    theme_icon_color: "Custom"
                    icon_color: "white"

                # Botão de Notificações
                MDIconButton:
                    icon: "bell"
                    pos_hint: {"center_x": 0.70, "top": 0.93}
                    theme_icon_color: "Custom"
                    icon_color: "white"

                # Gráfico Diário
                Graph:
                    id: profile_graph_day
                    size_hint: 0.88, 0.30
                    pos_hint: {"center_x": 0.5, "top": 0.785}
                    xlabel: ""
                    ylabel: "Nível (mg/dL)"
                    xmin: 6
                    xmax: 24
                    ymin: 0
                    ymax: 300
                    x_ticks_minor: 1
                    x_ticks_major: 6
                    y_ticks_major: 70
                    x_grid_label: True
                    y_grid_label: True
                    x_grid: True
                    y_grid: True
                    padding: 10
                
                # Gráfico Mensal
                Graph:
                    id: profile_graph_month
                    size_hint: 0.88, 0.30
                    pos_hint: {"center_x": 0.5, "top": 0.44}
                    xlabel: ""
                    ylabel: "Nível (mg/dL)"
                    xmin: 6
                    xmax: 24
                    ymin: 0
                    ymax: 300
                    x_ticks_minor: 1
                    x_ticks_major: 6
                    y_ticks_major: 70
                    x_grid_label: True
                    y_grid_label: True
                    x_grid: True
                    y_grid: True
                    padding: 10

                # Imagem Glicemia
                Image:
                    source: root._imgRegGlic
                    size_hint: 0.6, 0.4
                    pos_hint: {"center_x": 0.52, "top": 0.28}

                # Botão de registrar glicemia
                MDButton:
                    style: "filled"
                    pos_hint: {"center_x": 0.58, "top": 0.105}
                    size_hint: None, None
                    size: "286dp", "40dp"

                    MDButtonIcon:
                        icon: "plus"

                    MDButtonText:
                        text: "Registrar Glicemia"
                        font_style: "Title"
                        theme_font_size: "Custom"
                        font_size: "14sp" 

    # Barra de Navegação Inferior
    MDNavigationBar:
        id: nav_bar

        MDNavigationItem:
            name: "screen_guides"
            text: "Guias"
            on_release: screen_manager.current = "screen_guides"
            indicator_color: 0.153, 0.153, 0.153, 1

            MDNavigationItemIcon:
                icon: "book"

        MDNavigationItem:
            name: "screen_home"
            text: "Início"
            on_release: screen_manager.current = "screen_home"

            MDNavigationItemIcon:
                icon: "home"

        MDNavigationItem:
            name: "screen_profile"
            text: "Perfil"
            on_release: screen_manager.current = "screen_profile"

            MDNavigationItemIcon:

                icon: "account"
